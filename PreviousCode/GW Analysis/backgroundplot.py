from scipy.stats import linregress
import matplotlib.pyplot as plt
import numpy as np


#run number and background dictionary, copy-pasted 
d = {13341: 0.00018069850815311667, 13346: 0.00017508912709989107, 13348: 6.127488526277735e-05, 13349: 0.0003730351539003157, 13350: 0.00010242788223524952, 13351: 0.00016988467444215753, 13352: 6.998586285570315e-05, 13353: 0.00019674453378103646, 13354: 0.00023306906572424988, 13357: 0.00019823570224997521, 13358: 0.00034397831560698417, 13359: 0.00022689697213553917, 13360: 0.00018071884794316136, 13361: 0.00021927137412210837, 13362: 0.00010529488490610985, 13363: 0.00018162641263185753, 13364: 0.00025905024409009247, 13367: 0.00022922141575236533, 13368: 0.00020817747129427838, 13369: 0.0001712761920822969, 13370: 0.00017137056908211288, 13371: 0.00019401351886199432, 13372: 0.00016846819644428433, 13373: 0.00020156847146596718, 13376: 0.00012195832548508924, 13377: 0.00019323322993208497, 13378: 0.00015639091473046025, 13379: 0.000214103821619401, 13380: 0.000161169012571183, 13381: 0.00015595717415997566, 13382: 0.00023302629960709177, 13385: 0.0002586312005290856, 13386: 0.00014730143766203158, 13387: 0.0001466701476381706, 13388: 0.00011027095148078134, 13390: 0.00013332995564112378, 13391: 0.0001691838182184944, 13392: 0.00014440912838982378, 13393: 0.0002617804854282802, 13394: 0.00013257271945093683, 13397: 0.00020101418356079204, 13398: 0.0, 13399: 0.00023303674552533038, 13400: 0.00019876737723795502, 13401: 0.00010736194260698952, 13402: 0.00023773929508900542, 13403: 0.00019221016555209412, 13000: 0.00013845333776384014, 13001: 0.00017063868842228687, 13003: 0.0, 13004: 0.0001861950827947468, 13005: 6.265601347354913e-05, 13006: 0.00017299610625686994, 13007: 0.0003136828457307765, 13008: 0.00017000975594445652, 13011: 0.0001569228475742997, 13012: 0.0001427273289531902, 13013: 0.00018460894697005438, 13014: 0.0002783282492039812, 13015: 0.0003304343228739856, 13016: 0.00029571598526879445, 13017: 0.00023119115462642397, 13018: 0.0001449283000173914, 13019: 0.0003847604096928842, 13020: 0.00011525591294848956, 13023: 0.00016286843894672978, 13024: 0.0002846010152494399, 13025: 0.00024100970381175875, 13026: 0.00016325819828252376, 13027: 0.00021430875247660552, 13028: 7.370228698196505e-05, 13029: 0.00019503594512468647, 13030: 0.00011762722364464031, 13033: 0.0, 13034: 0.00013860974426502183, 13038: 0.00013559616208622832, 13039: 0.0001974267698550584, 13040: 0.0003084928069760507, 13041: 0.0002166985340981517, 13042: 0.00018804238475352345, 13043: 0.00022000349417314276, 13044: 0.00016988001244044399, 13048: 0.000131751958492863, 13049: 0.00015998762762346378, 13050: 0.0001748835006833909, 13051: 6.255230936870958e-05, 13053: 0.0002742460974780329, 13054: 6.874742197167606e-05, 13055: 0.00018135864000804573, 13056: 0.00019539620488464457, 13059: 0.00017318370261427458, 13060: 0.0002266588595281718, 13062: 0.00012496355229724664, 13063: 0.00011604091602699112, 13064: 0.00013898202614946823, 13065: 0.00019425447076664468, 13066: 0.00015668312274686407, 13067: 0.00020648411749978705, 13069: 0.00019005238658284453, 13075: 0.00022556342521283518, 13076: 0.00016951981556244066, 13077: 7.346836819407405e-05, 13078: 0.0, 13079: 0.00028065273589642046, 13083: 0.0002497614777887118, 13084: 0.0001290353798882231, 13087: 0.0002173426384961628, 13088: 0.0002737847217695358, 13089: 0.0002084826373053619, 13090: 0.0, 13091: 0.00014364026210430373, 13092: 0.0002091404848922142, 13093: 0.00018882828899540203, 13096: 0.00014006073033267222, 13097: 4.308506283956415e-05, 13100: 0.00016214003223884307, 13101: 0.00022337589301083113, 13102: 0.0002452271061136408, 13103: 0.00021308281108314728, 13106: 0.00020854235842870285, 13107: 0.0002502164372181937, 13108: 0.00023573415473589917, 13109: 0.00018364775870153687, 13110: 0.00019414944514862143, 13111: 0.00022541927986054062, 13112: 0.00021186141438680244, 13113: 0.00019528913777404558, 13114: 0.0002606362391233239, 13115: 0.00016339491052086213, 13116: 0.00015204288623010928, 13117: 0.00010606320943029207, 13121: 0.0, 13122: 0.0002208812277462163, 13123: 9.072450777418307e-05, 13124: 0.0, 13125: 0.00021424802958765288, 13128: 9.209573044193672e-05, 13129: 0.0002866347928776987, 13130: 0.00026438939269756497, 13133: 0.00016102497765778433, 13134: 0.00010429459050032723, 13135: 0.00017826778563984422, 13136: 0.0003877368202906689, 13137: 0.00014212896265238485, 13140: 0.00016983599504078893, 13141: 0.00021631911395690923, 13142: 0.00015817466437313403, 13143: 0.00040144359115378903, 13151: 0.00018353001633417146, 13152: 0.0001713970042440535, 13153: 0.00024632042657512186, 13154: 0.00019220986241618048, 13155: 0.0002888598570143708, 13156: 0.00012964014488582592, 13157: 0.00011381562324297132, 13158: 0.0002453992031537303, 13159: 0.0002618143736091111, 13162: 0.0001559600118529609, 13163: 0.00018993197721901597, 13164: 0.00019184284234355215, 13165: 0.00015525318560130204, 13166: 0.00016805636351884172, 13167: 0.0002204171069606426, 13168: 0.0002480566718105787, 13171: 0.00013986131352151208, 13172: 0.00012092731905342931, 13173: 0.00040846753193705514, 13174: 0.00018213585513434473, 13175: 0.00011717544679648839, 13176: 0.00022135964301200157, 13177: 0.00018363931140505063, 13180: 0.00018200751691044843, 13181: 0.00017560187542802955, 13182: 0.00020818613922708292, 13183: 0.00016790377305609406, 13184: 0.00018142258633447328, 13185: 0.00025998538882114825, 13186: 0.00014309371207203597, 13189: 0.00013417433808444665, 13190: 0.00023326637724356897, 13191: 0.00014233309826806498, 13192: 0.00020559342615019885, 13193: 0.00016886099363004376, 13194: 0.00016717419036253652, 13195: 0.00017364056136657792, 13198: 0.000152494233811784, 13200: 0.00015494987371585293, 13201: 0.00012966889048813854, 13202: 0.00014552157357328223, 13203: 0.0002037614361106017, 13204: 0.00019718920867970555, 13206: 0.00015689523164011998, 13210: 0.00019575847319577106, 13211: 8.753961167428261e-05, 13212: 0.00023363830920628394, 13213: 0.00021232803088311208, 13214: 0.00018129736393632836, 13215: 0.00032570531485932787, 13216: 0.00019582526642027498, 13217: 0.00016828173987785337, 13220: 0.0001965452584766694, 13221: 0.0001749101156350209, 13222: 0.00021408290895856696, 13223: 0.00015343228010597057, 13224: 0.00020259921283452507, 13225: 0.00017213955698163616, 13226: 0.00020877218987413126, 13227: 0.0001188024710913987, 13230: 0.00013397749713958045, 13231: 0.0002125514274821025, 13232: 0.00014163302882232138, 13233: 0.00020235874411104435, 13234: 0.00014359113598863804, 13235: 0.00029693434652496443, 13236: 9.371418779252215e-05, 13239: 0.00012505314758772478, 13247: 0.0001776589436843356, 13250: 0.00019543286425102962, 13251: 0.0, 13252: 0.00018497333538226876, 13253: 0.00010268231887480715, 13254: 0.00012938183944748779, 13255: 0.00014692172277740823, 13256: 0.0002519932667399127, 13257: 0.00022003531566816472, 13258: 0.00010560431541474512, 13259: 0.0001859128744665568, 13262: 0.0002299881556099861, 13263: 0.00016311107184363086, 13264: 0.00015412540354180177, 13265: 0.00011759940416301891, 13266: 0.0002099698955662232, 13267: 0.0001751797276629003, 13268: 0.00022262817507974416, 13272: 0.00022563399627421863, 13274: 0.0001271139042273, 13275: 0.00016327916819060557, 13276: 0.0001944895552162793, 13277: 0.0002068559829860954, 13278: 0.0001485019528006793, 13279: 9.05122476001324e-05, 13280: 0.00016861547241515723, 13283: 0.00015431443881625394, 13284: 0.0001597914189344842, 13285: 0.00014315423437211253, 13286: 0.0002823992123629241, 13287: 6.632223320223639e-05, 13291: 0.0002190535717415051, 13295: 0.0001347005438534458}

print "minimum", min(d.values())

m,b = np.polyfit(d.keys(), d.values(), 1, rcond=None, full=False, w=None, cov=False)
print m,b

print "linear regression", linregress(d.keys(), d.values())

plt.scatter(d.keys(),d.values())
plt.ticklabel_format(style='sci', axis='y', scilimits=(0,0))
plt.xlim(12996,13406)
plt.title("Stationarity of background")
plt.xlabel("run number")
plt.ylabel("background event rate (per sec)")
plt.text(13050,1.5e-3,"slope of best fit line: %s" % m)
plt.plot(np.array(d.keys()), m*np.array(d.keys()) + b, '-')
plt.savefig("eventrate_nocuts_09MeV_v2.eps", format = "eps", dpi= 1000)
plt.show()
